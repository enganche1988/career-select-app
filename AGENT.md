# AGENT.md

## CareerSelect開発用AIエージェント運用ルール

1. **日本語で説明・記載すること。**
2. **コンポーネントは適度に分割すること。**
   - UI/ロジック/型など役割ごとに整理する。
3. **型安全を最優先とし、型定義を明示的に行うこと。**
4. **認証やインフラは将来的な拡張（Clerk/Auth0, 本番DB等）ができるよう疎結合に保つこと。**
5. **設計・コード・スキーマなど、何らかの変更を加えたらその内容・理由・動作確認について必ず説明すること。**
6. **コミットやPRごとに、何をしたかを簡潔に要約すること。**

## 作業効率化ルール（指示回数最小化を最優先）

7. **AI は原則としてタスクを細分化せず、1回の指示で完遂可能な範囲を最大限広げること。**
   - 可能な限り複数ファイル編集・複数UI改修・スタイル調整・マイグレーションなどを "一括で" 実行する。
   - 関連する変更はすべて一度に実装する。

8. **途中で「どうしますか？」と質問せず、一般的なベストプラクティス・過去の文脈・デザイン例から判断し、AI 自身が最適な選択をして作業を進める。**
   - 明らかにこの方が良い場合は AI の判断で積極的に改修する。
   - 安全のための確認質問は最小限にする。

9. **画面構成・レイアウト・デザイン・コンポーネント分割が複数関係する場合も、"一回の実装指示" の中で、すべてのファイルをまたいだ一括改修を行う。**
   - 例：layout修正＋カード修正＋フィルタ修正＋スタイリング調整を一度に行う。

10. **AI は指示文の意図を「大きな変更を求めている」と判断した場合、既存コードの微調整ではなく全面リファクタリングを許可されている。**

11. **ユーザーは手を動かさないため、AI は必要なコード・ファイル生成・マイグレーション・seed更新をすべて自律的に行うこと。**

12. **UIを修正する際、グリッド数・カードの縦横比・Tailwind構成を AI が判断して良い。細かい明示指示がなくても、自動で調整してよい。**

13. **動作確認が必要な場合も、AI がサーバー起動→確認→修正まで連続して行う。ユーザーに指示を求めない。**

---

## 開発方針（2025-12-13更新）

### 1. デプロイ確認の優先度
- **日常の進捗確認**: ローカルで `npm run build` が通ることを合格ラインとする
- **Vercelでの確認**: 機能がまとまった単位でのみ行う
- **優先度**: Vercelデプロイ確認は一旦優先度を下げる

### 2. 開発の主軸
- **プロダクトブラッシュアップ**を最優先
- **求職者向け公開画面**（検索・一覧・詳細）のUX改善を最優先
- **管理画面**（コンサル編集）は運用前提で最低限きれいにする

### 3. 管理画面の設計前提（重要）
初期フェーズでは以下2パターンが混在する前提で設計する：
- **a. Admin（オーナー）がコンサルタントの代わりに編集する**
- **b. コンサルタント本人がログインして編集する**

**設計要件**:
- 権限とUIは「代行編集」「本人編集」どちらも可能な設計にする
- 編集対象が誰か（Acting as）は常にUI上で明示する

### 4. 編集項目のブラッシュアップ方針
- **検索軸に使う項目**: 自由入力を避けて選択式・タグ式を優先
- **編集項目の構造**: 「求職者の検索UXを良くすること」を最優先で決める
- **画像アップロード**: 失敗しても保存全体が壊れない設計にする

### 5. 画面分離の方針
- **公開（求職者）画面**と**管理（コンサル）画面**は明確に分離する
- コンサルが第三者に共有するのは「求職者向け公開ページ」のみ
- 管理画面（`/dashboard` 等）は公開導線から隠す

---

## コンサルタント管理構造（公式仕様）

### 基本方針
CareerSelect では、コンサルタント情報を以下の3レイヤーで管理します：

1. **プロフィール情報（検索軸）** - `ConsultantProfile` モデルで管理
2. **自己申告の実績（selfReportedXXX）** - `ConsultantProfile` 内の selfReported フィールド
3. **CareerSelect プラットフォーム内の実績（platformXXX）** - `ConsultantStats` モデルで自動計測

### 重要原則
- **MVP フェーズ**: selfReported のみ利用
- **後期フェーズ**: platformXXX を自動集計して反映
- **verified（platform実績）は手動編集不可** - 中抜き防止のため
- **スキーマ設計**: Consultant, ConsultantProfile, ConsultantStats の3モデル構成

### 詳細仕様
詳細は以下のドキュメントを参照：
- `docs/consultant-management-spec.md` - 完全な仕様書
- `docs/prisma-schema-migration-plan.md` - スキーマ移行プラン
- `docs/consultant-registration-ui-mock.md` - UI実装ガイド

### 実装時の注意事項
- ConsultantProfile の selfReported フィールドはコンサルタント本人のみ編集可能
- ConsultantStats はシステムのみ更新可能（手動編集不可）
- 既存の Consultant フィールドは後方互換性のため段階的に非推奨化
