# 開発方針（Development Policy）

## 更新日
2025-12-13（最新）

## 基本方針

### 1. デプロイ確認の優先度（⚠️ 暫定許容）

- **日常の進捗確認**: ローカルで `npm run build` が通ることを合格ラインとする
- **Vercelでの確認**: 機能がまとまった単位でのみ行う
- **優先度**: **Vercelデプロイ確認は一旦優先度を下げる**（暫定許容）
- **理由**: 初期フェーズではプロダクトブラッシュアップを最優先し、Vercelデプロイ確認は一旦優先度を下げる

### 2. 開発の主軸

- **プロダクトブラッシュアップ**を最優先
- **求職者向け公開画面**（検索・一覧・詳細）のUX改善を最優先
- **管理画面**（コンサル編集）は運用前提で最低限きれいにする

### 3. 管理画面の設計前提（重要）

初期フェーズでは以下2パターンが混在する前提で設計する：

- **a. Admin（オーナー）がコンサルタントの代わりに編集する**
- **b. コンサルタント本人がログインして編集する**

**設計要件**:
- 権限とUIは「代行編集」「本人編集」どちらも可能な設計にする
- 編集対象が誰か（Acting as）は常にUI上で明示する

### 4. 編集項目のブラッシュアップ方針

- **検索軸に使う項目**: 自由入力を避けて選択式・タグ式を優先
- **編集項目の構造**: 「求職者の検索UXを良くすること」を最優先で決める
- **画像アップロード**: 失敗しても保存全体が壊れない設計にする

### 5. 画面分離の方針

- **公開（求職者）画面**と**管理（コンサル）画面**は明確に分離する
- コンサルが第三者に共有するのは「求職者向け公開ページ」のみ
- 管理画面（`/dashboard` 等）は公開導線から隠す

## 暫定許容事項（⚠️ エンジニア引き継ぎ時に修正が必要）

### DB非依存の公開ページ
- **現状**: Vercelビルド成功のために、公開ページ（トップ/一覧/詳細）はDB接続失敗時にダミーデータを使用
- **理由**: Neon PostgreSQLへの接続設定が未完了のため、ビルドを成功させるための暫定対応
- **対応**: DB接続が確立したら、ダミーデータフォールバックを削除し、適切なエラーハンドリングに置き換える
- **詳細**: `HANDOVER_FOR_ENGINEERS.md`を参照

### migrate deployの削除
- **現状**: `package.json`のbuildスクリプトから`prisma migrate deploy`を削除
- **理由**: DB接続が未確立のため、migrate deployが失敗してビルドが落ちるのを防ぐため
- **対応**: DB接続が確立したら、buildスクリプトに`prisma migrate deploy`を復元
- **詳細**: `HANDOVER_FOR_ENGINEERS.md`を参照

## 実装時のチェックリスト

### 求職者向け公開画面
- [ ] 検索・フィルタリングのUXが最適化されているか
- [ ] 一覧表示が分かりやすく、情報が適切に表示されているか
- [ ] 詳細ページで必要な情報がすべて表示されているか
- [ ] モバイル対応が適切か
- [ ] DB接続失敗時にダミーデータで表示できるか（暫定）

### 管理画面
- [ ] Admin（オーナー）とコンサルタント本人の両方で編集可能か
- [ ] 編集対象が誰か（Acting as）がUI上で明示されているか
- [ ] 検索軸の項目が選択式・タグ式になっているか
- [ ] 画像アップロードが失敗しても保存全体が壊れない設計か
- [ ] 公開導線から管理画面へのリンクが隠されているか

### 開発フロー
- [ ] ローカルで `npm run build` が通るか
- [ ] 機能がまとまった単位でVercelデプロイを確認する（暫定では優先度低）

## 今後の実装優先順位

1. **求職者向け公開画面のUX改善**（最優先）
   - 検索・フィルタリング機能の改善
   - 一覧表示の最適化
   - 詳細ページの情報整理

2. **管理画面の基本機能**
   - Admin/コンサルタント本人の両方で編集可能にする
   - Acting asの明示
   - 検索軸項目の選択式・タグ式化

3. **画像アップロードの堅牢化**
   - 失敗時のエラーハンドリング
   - 保存全体が壊れない設計

4. **画面分離の徹底**
   - 公開導線から管理画面へのリンクを隠す
   - 管理画面へのアクセス制御

5. **DB接続の確立と暫定対応の解消**（エンジニア引き継ぎ時）
   - Vercel環境変数にNeon PostgreSQL接続情報を設定
   - migrate deployの復元
   - ダミーデータフォールバックの削除

## ドキュメント更新ルール

**暫定対応に触れる変更を行った場合、以下のドキュメントも同時に更新すること**:
- `CURRENT_STATUS.md` - 現状の整理
- `DEVELOPMENT_POLICY.md` - 開発方針
- `HANDOVER_FOR_ENGINEERS.md` - エンジニア引き継ぎ用ドキュメント

詳細は `AGENT.md` を参照してください。
