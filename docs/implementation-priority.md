# CareerSelect 実装タスク優先順位リスト

## 現状分析

### ✅ 既に実装済み
- Consultantモデルに検索軸プロフィール・自己申告実績フィールドが追加済み
- プロフィール編集UIが実装済み
- PostgreSQL移行完了
- 基本的なCRUD操作が動作

### ⚠️ 課題
- ConsultantProfile / ConsultantStats の独立モデルが未実装
- データがConsultantモデルに直接保存されている（暫定実装）
- 将来の拡張性を考慮した設計への移行が必要

---

## 優先順位リスト

### 🔴 Phase 1: 今すぐ実装すべき（緊急度：高）

#### 1. Consultantモデルにemailフィールドを追加（必須）
**理由**: 仕様ではConsultantにemailが必要だが、現在はUserとのリレーションのみ
**影響**: 認証・ログイン機能の実装に必要
**作業量**: 小（1時間）

```prisma
model Consultant {
  email String @unique // 追加が必要
  // ...
}
```

#### 2. 検索軸プロフィールの必須フィールドを明確化
**理由**: 年代（ageRange）は必須だが、現在はnullable
**影響**: 検索・マッチング機能の精度向上
**作業量**: 小（30分）
- ageRangeを必須にするか、デフォルト値の設定
- 既存データの移行スクリプト

#### 3. 得意業界・得意職種の配列フィールドを追加
**理由**: 現在はexpertiseRoles/expertiseCompanyTypesのみ。業界情報が不足
**影響**: より詳細な検索・マッチングが可能に
**作業量**: 中（2時間）
- specialtyIndustries: String[] を追加
- specialtyJobFunctions: String[] を追加（expertiseRolesと統合検討）
- 既存データの移行

#### 4. 型安全性の向上
**理由**: 現在、Json型を多用しているため型安全性が低い
**影響**: 開発効率・バグ防止
**作業量**: 中（3時間）
- TypeScript型定義の作成
- Json型から適切な型への変換ヘルパー関数

---

### 🟡 Phase 2: 今月中に実装すべき（緊急度：中）

#### 5. ConsultantProfileモデルの追加（段階的移行）
**理由**: 将来の拡張性・データ整合性のため
**影響**: 大きなリファクタリングが必要だが、長期的には必須
**作業量**: 大（8-10時間）
- ConsultantProfileモデルの作成
- 既存データの移行スクリプト
- アプリケーションコードの更新
- 後方互換性の維持

**移行戦略**:
1. ConsultantProfileモデルを追加（Consultantと1対1）
2. 既存データを移行
3. アプリケーションコードを段階的に更新
4. 古いフィールドを非推奨化

#### 6. ConsultantStatsモデルの追加
**理由**: platform実績の自動集計のため
**影響**: フェーズ2以降の機能実装に必要
**作業量**: 中（4時間）
- ConsultantStatsモデルの作成
- 初期値（0）でのレコード作成
- 自動集計ロジックの準備（実装は後回し）

#### 7. 検索・フィルタリング機能の実装
**理由**: 検索軸プロフィールを活用する機能
**影響**: ユーザー体験の向上
**作業量**: 大（6-8時間）
- 年代・学歴・前職業界でのフィルタリング
- 得意業界・得意職種での検索
- 検索結果のソート機能

---

### 🟢 Phase 3: 後回しでよい（緊急度：低）

#### 8. platform実績の自動集計機能
**理由**: フェーズ2以降の機能
**影響**: 中抜き防止の仕組み
**作業量**: 大（10-12時間）
- Consultation status変更の監視
- Review作成・承認の監視
- 転職完了の判定ロジック
- ConsultantStatsの自動更新バッチ

#### 9. ConsultantProfileへの完全移行
**理由**: 段階的移行の完了
**影響**: コードの整理・保守性向上
**作業量**: 中（4-6時間）
- 古いフィールドの削除
- すべてのコードをConsultantProfile経由に変更
- テストの更新

#### 10. 高度な検索機能
**理由**: 基本検索が動作してから
**影響**: ユーザー体験のさらなる向上
**作業量**: 大（8-10時間）
- 複合条件検索
- 検索履歴
- おすすめ機能

---

## 推奨実装順序

### Week 1: 基盤整備
1. ✅ Consultant.email の追加
2. ✅ 検索軸プロフィールの必須フィールド明確化
3. ✅ 得意業界・得意職種の配列フィールド追加
4. ✅ 型安全性の向上

### Week 2-3: モデル設計の改善
5. ✅ ConsultantProfileモデルの追加と段階的移行
6. ✅ ConsultantStatsモデルの追加

### Week 4: 機能実装
7. ✅ 検索・フィルタリング機能の実装

### 将来: 高度な機能
8. ⏳ platform実績の自動集計
9. ⏳ ConsultantProfileへの完全移行
10. ⏳ 高度な検索機能

---

## 重要な判断ポイント

### 今すぐやるべき理由
- **データ整合性**: 必須フィールドの明確化により、データ品質が向上
- **開発効率**: 型安全性の向上により、バグが減り開発速度が上がる
- **ユーザー体験**: 検索機能の実装により、プラットフォームの価値が高まる

### 後回しでよい理由
- **ConsultantProfile移行**: 現在の暫定実装でも動作しているため、緊急ではない
- **platform実績**: フェーズ2以降の機能のため、MVPでは不要
- **高度な機能**: 基本機能が動作してから検討

---

## リスクと対策

### リスク1: ConsultantProfile移行時のデータ損失
**対策**: 
- 移行前に全データをバックアップ
- 移行スクリプトをテスト環境で実行
- 段階的な移行（古いフィールドを残す）

### リスク2: 既存コードの破壊
**対策**:
- 後方互換性を保つ
- 段階的なリファクタリング
- 十分なテスト

### リスク3: パフォーマンス低下
**対策**:
- 適切なインデックスの設定
- クエリの最適化
- 必要に応じてキャッシュの導入

